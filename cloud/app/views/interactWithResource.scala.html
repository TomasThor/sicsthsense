@(resourceId: Long, resourceUrl: String, showHeader: Boolean = true)

@helpMark(text: String, apiLocation: String="") = {
<!--
  ~ Copyright (c) 2013, Swedish Institute of Computer Science
  ~ All rights reserved.
  ~ Redistribution and use in source and binary forms, with or without
  ~ modification, are permitted provided that the following conditions are met:
  ~     * Redistributions of source code must retain the above copyright
  ~       notice, this list of conditions and the following disclaimer.
  ~     * Redistributions in binary form must reproduce the above copyright
  ~       notice, this list of conditions and the following disclaimer in the
  ~       documentation and/or other materials provided with the distribution.
  ~     * Neither the name of The Swedish Institute of Computer Science nor the
  ~       names of its contributors may be used to endorse or promote products
  ~       derived from this software without specific prior written permission.
  ~
  ~ THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
  ~ ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
  ~ WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  ~ DISCLAIMED. IN NO EVENT SHALL THE SWEDISH INSTITUTE OF COMPUTER SCIENCE BE LIABLE
  ~ FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
  ~ (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
  ~ LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
  ~ ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  ~ (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  ~ SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  -->

<a href="@routes.Public.about()#@apiLocation" class="helptooltip" data-toggle="tooltip" title="@text"><i class="icon-question-sign"></i></a>
}

	@if(Utils.isValidURL(resourceUrl)) {
<div class="row-fluid ">
	 <form id="proxy@resourceId" action="@routes.Proxy.forwardById(resourceId, "")" class="controls-row " >
<fieldset>
  @if(showHeader) {<legend>Interact with 	@helpMark("Send requests to the resource directly","proxyHelp")<span id="ajax_wait@resourceId" style="display: none" class="pull-right">
<img src='@routes.Assets.at("images/ajax_wait.gif")' alt="wait-spin"></span></legend>}
	 	 <select class="span2" id="method@resourceId" name="method" >
   		<option value="GET" selected="selected">GET</option>
    	<option value="POST">POST</option>
    	<option value="PUT">PUT</option>
    	<option value="DELETE">DELETE</option>
		 </select>
		 <input class="span4" type="text" id="arguments@resourceId" name="arguments" placeholder="request query arguments ?arg=value" />
     <input class="span4" type="text" id="body@resourceId" name="body" placeholder="request body" />
		 <input class="span2 btn btn-primary" type="submit" name="send" id="send@resourceId" value="Send">
	 </fieldset></form>

	<div id="response@resourceId" style="display: none" class="controls-row ">
<fieldset>
		<div class="span2"><a id="hide@resourceId" href="#" class="icon-remove btn-icon"></a>&nbsp
		<span id="response1@resourceId"></span></div>
	  <textarea class="span10" id="response2@resourceId" name="response2@resourceId" wrap="soft"></textarea>
</fieldset>
	</div>
   </div>

     <script type="text/javascript">
	  $('#proxy@resourceId').submit(function() {
	    var method = $("select#method@resourceId").val();
	    var arguments = $("input#arguments@resourceId").val();
	    var url = "@routes.Proxy.forwardById(resourceId, "")" + arguments;
	    var body = $("input#body@resourceId").val();
	    $("#ajax_wait@resourceId").show(); //css("visibility","visible");
	    console.debug("[Proxy] Method: " + method + " URL: " + url + " Args: " + arguments + " Body: " + body);

	    $.ajax({
	    	  url: url,
	    	  context: document.body,
	    	  timeout: @Proxy.REQUEST_TIMEOUT,
	    	  type: method,
	    	  data: body,
	    	  contentType: "text/plain",
    	    error: function(x, t, m) {
    	    	$("#response1@resourceId").html("Error");
    	    	$("#response2@resourceId").text(m);
            $("#response@resourceId").show();
    	    	$("#ajax_wait@resourceId").hide();//.css("visibility","hidden");
    	    },
    	    success: function(response) {
    	    	$("#response1@resourceId").html("Response");
            $("#response2@resourceId").text(response);
            $("#response@resourceId").show();
            $("#ajax_wait@resourceId").hide();//.css("visibility","hidden");
           }
	    	});

	    return false;
	  });

	  $('#hide@resourceId').click(function() {
		  $("#response@resourceId").hide();
	      return false;
	    });

	  </script>
	}
